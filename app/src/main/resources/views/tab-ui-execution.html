<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<body>
<!-- Layout -->
<div th:fragment="tab" th:remove="tag">

    <div class="space-y-4">
        <h3 class="text-lg font-semibold">Dynamic UI Execution</h3>

        <!-- Dynamic UI Elements -->
        <div class="bg-gray-50 rounded-lg p-4">
            <template x-if="parsedUIConfig.length > 0">
                <div class="space-y-4">
                    <template :key="element.name" x-for="element in parsedUIConfig">
                        <div x-ui-element="element"></div>
                    </template>
                </div>
            </template>
            <template x-if="parsedUIConfig.length === 0">
                <p class="text-gray-600 text-center py-8">No UI elements configured. Configure them in
                    the UI Configuration tab.</p>
            </template>
        </div>

        <!-- Execution Controls -->
        <div class="flex gap-4" x-cloak x-show="script?.id">
            <button :disabled="loading.executeScript"
                    @click="executeScriptById()"
                    class="px-6 py-3 bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-700 hover:to-purple-700 disabled:opacity-50 text-white font-semibold rounded-lg transition-all transform hover:scale-105">
                <span x-cloak x-show="!loading.executeScript">Execute with UI Data</span>
                <span x-cloak x-show="loading.executeScript">Executing...</span>
            </button>
            <button @click="clearUIData()"
                    class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                Clear UI Data
            </button>
        </div>

        <!-- UI Data Preview -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 overflow-x-auto"
             x-cloak x-show="Object.keys(uiData).length > 0">
            <h4 class="font-semibold mb-2">Current UI Data:</h4>
            <pre class="text-sm text-gray-700" x-text="JSON.stringify(uiData, null, 2)"></pre>
        </div>
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 overflow-x-auto"
             x-cloak x-show="uiResult && Object.keys(uiResult).length > 0">
            <h4 class="font-semibold mb-2">Current UI Result:</h4>
            <pre class="text-sm text-gray-700" x-text="JSON.stringify(uiResult, null, 2)"></pre>
        </div>
        <div class="bg-grey-50 border border-gray-200 rounded-lg p-4 relative" x-cloak
             x-show="script?.id">
            <button @click="navigator.clipboard.writeText(curlExampleById).then(() => { $el.textContent = 'Copied!'; setTimeout(() => $el.textContent = 'Copy', 1000); })"
                    class="absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-600 transition-colors">
                Copy
            </button>
            <pre class="text-sm text-gray-700 truncate" x-text="curlExampleById"></pre>
        </div>
    </div>

</div>
</body>
</html>